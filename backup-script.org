#+title: Arch Backup/Restore Script
* Filesystem Overview
:PROPERTIES:
:VISIBILITY: folded
:END:
** TODO bin -> usr/bin/
** TODO boot/
** TODO dev/
** etc/
*** profile
Created during arch install and optionally copied to  [[* .xprofile][~/.xprofile]]
*** X11/
**** xinit/
***** xinitrc
Created during arch install (awesomewm flavor) and optionally copied to [[* .xinitrc][~/.xinitrc]]
**** xorg.conf.d/
Xorg configuration files (for more info see [[https://www.x.org/releases/current/doc/man/man5/xorg.conf.5.xhtml][xorg docs]])
***** 00-keyboard.conf
***** 30-touchpad.conf
*** oblogout.conf
+ TODO check if we can move this to ~/.config
** ~/
*** .xinitrc
Optionally copied from [[* xinitrc][/etc/X11/xinitrc]]
*** .xprofile
Optionally copied from [[* profile][/etc/profile]]
** TODO lib -> usr/lib/
** TODO lib64 -> usr/lib/
** TODO mnt/
** TODO opt/
** TODO proc/
** TODO root/
** TODO run/
** TODO sbin -> usr/bin/
** TODO .snapshots/
** TODO srv/
** TODO sys/
** TODO tmp/
** TODO usr/
** TODO var/
* Backing Up
** Generate Package Lists
*** List Explicitly Installed Packages from Pacman
#+begin_src sh :results packages file :file pacman-packages.txt :tangle backup.sh
pacman -Qqen > pacman-packages.txt
#+end_src

#+RESULTS:
[[file:pacman-packages.txt]]

*** List Explicitly Installed AUR Packages
#+begin_src sh :results aur-packages file :file aur-packages.txt :tangle backup.sh
pacman -Qqem > aur-packages.txt
#+end_src

#+RESULTS:
[[file:aur-packages.txt]]
** Create Backup Destination
#+begin_src sh :eval never :tangle backup.sh
read -p "Backup Destination: " BACKUPDEST
BACKUPPATH=$BACKUPDEST/$USER-backup
mkdir -p $BACKUPPATH$HOME
BACKUPPATH=$BACKUPDEST/$USER-backup/
#+end_src

** Backup Home Folder

* Restoring
** Restore Packages
*** Install Pacman Packages
#+begin_src sh
pacman -Syu --needed - < pacman-packages.txt
#+end_src
*** Install AUR Packages
**** Install Yay
Install ~yay~ using the command from the [[https://github.com/Jguer/yay][repository's homepage]]
#+begin_src sh :tangle restore.sh
pacman -Syu --needed git base-devel && git clone https://aur.archlinux.org/yay.git && cd yay && makepkg -si
#+end_src
**** Install Aur Packages
#+begin_src emacs-lisp
yay -Syu --needed - < aur-packages.txt
#+end_src


#+RESULTS:

# Local Variables:
# eval: (flyspell-mode -1)
# End:
